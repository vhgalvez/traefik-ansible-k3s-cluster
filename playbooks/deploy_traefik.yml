# playbooks\deploy_traefik.yml
- name: 🔁 Flujo completo: generar, subir y desplegar Traefik con GitOps
  hosts: localhost
  gather_facts: false

  tasks:

    - name: 🔐 Paso 1 - Generar y cifrar SealedSecret para Traefik
      import_playbook: generate_traefik_secrets.yml

    - name: 📄 Paso 2 - Subir SealedSecret al repositorio GitOps (ArgoCD)
      import_playbook: push_traefik_sealedsecret.yml

    - name: 🚀 Paso 3 - Instalar Traefik con Helm
      import_playbook: install_traefik.yml